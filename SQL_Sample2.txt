SELECT ROWNUM ID, ADR.LLINK_LLATTRDATA.ID objId, ADR.LLINK_DTREE_VW.NAME FOLDER_NAME, VALSTR
  FROM ADR.LLINK_LLATTRDATA
  JOIN ADR.LLINK_DTREE_VW ON ADR.LLINK_LLATTRDATA.ID = ADR.LLINK_DTREE_VW.DATAID
  LEFT OUTER JOIN ADR.LLINK_gdcRecycleBin ON ADR.LLINK_LLATTRDATA.ID = ADR.LLINK_gdcRecycleBin.ID
  LEFT OUTER JOIN ADR.LLINK_KUAF_VW ON ADR.LLINK_DTREE_VW.CREATEDBY = ADR.LLINK_KUAF_VW.ID
  AND ADR.LLINK_KUAF_VW.DELETED !=1

  WHERE 
    ADR.LLINK_LLATTRDATA.ATTRTYPE = -1 
    AND TRIM(ADR.LLINK_LLATTRDATA.VALSTR) = TRIM(UPPER((SELECT afosr_awa_icn_numb FROM odf_ca_project WHERE id = @WHERE:PARAM:USER_DEF:INTEGER:PROJECT_ID@ )))
    AND EXISTS( SELECT 'AFOSR R&D Case File'
           FROM ADR.LLINK_CATREGIONMAP
            WHERE 
      ADR.LLINK_CATREGIONMAP.CATNAME = 'AFOSR R&D Case File'
              AND ADR.LLINK_CATREGIONMAP.CATID = ADR.LLINK_LLATTRDATA.DEFID )
     AND ADR.LLINK_gdcRecycleBin.ID IS NULL
  ORDER BY ADR.LLINK_DTREE_VW.CREATEDATE DESC )
WHERE ROWNUM = 1 ) RD_CASE_FILE
